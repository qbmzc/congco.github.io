---
title: Spring项目启动时执行一次的方法
date: 2022-07-05
categories:
  - Java
tags:
  - spring
sticky: 1
prev: 042158.md
next:
---



<!-- more -->

## 需求

在使用rabbimq的过程中会出现某一业务方突发大量请求的情况,故需要对之前的单一队列按业务进行拆分,之后获取业务的队列列表,然后轮询队列处理消息.

可以通过mq的api获取交换机绑定的所有队列,这个请求需要在服务启动时执行一次即可,后续新增通过消息通知.

## Spring MVC
1. 实现`ApplicationListener`,并实现`onApplicationEvevt`方法

```java
package com.cong.rabbit.config;

import org.springframework.context.ApplicationListener;
import org.springframework.context.event.ContextRefreshedEvent;
import org.springframework.stereotype.Component;

@Component
public class MyApplication implements ApplicationListener<ContextRefreshedEvent> {
    @Override
    public void onApplicationEvent(ContextRefreshedEvent event) {
        //do something
        System.out.println("init");
    }
}
```

输出

```bash
......
2022-07-05 23:39:11.378  INFO 7604 --- [  restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2022-07-05 23:39:11.428  INFO 7604 --- [  restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8084 (http) with context path ''
init
2022-07-05 23:39:11.436  INFO 7604 --- [  restartedMain] com.cong.rabbit.RabbitApplication        : Started RabbitApplication in 1.572 seconds (JVM running for 2.047)
```

## 