---
title: MQ消息接收之后数据库查询失败的问题
date: 2021-08-09
categories:
  - work
tags:
  - MQ
---


![20210809133659](https://gitee.com/snowyan/image/raw/master/2021/20210809133659.jpg)

<!-- more -->

## 问题

处理异步任务时，任务先提交至数据库保存，然后发送MQ消息通知消费者进行任务的下一步处理。

但是在消费者处理任务时，查询数据库却发现此任务不存在。

排查之后发现，由于在提交任务时存在事务，尚未提交，即发送了消息，所以另外一个事务无法读取未提交的事务，因此查询不到此次任务。


## 解决方法

去除任务提交时的事务
