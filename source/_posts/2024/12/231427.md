---
title: 挂载对象存储为本地磁盘
date: 2024-12-23
tags:
  - AWS
  - s3
categories: Linux
toc: true
---

## s3fs挂载

1. 安装
```bash
# ubuntu
sudo apt update
sudo apt install -y s3fs
```

2. **设置 AWS 凭据**
```bash
# 创建一个文件 /etc/passwd-s3fs，内容为：
<AWS_ACCESS_KEY_ID>:<AWS_SECRET_ACCESS_KEY>
```
3. 修改权限
```bash
sudo chmod 600 /etc/passwd-s3fs
```

4. **挂载 S3 存储桶**
```bash
s3fs tm-fs-test:/music -o use_cache=/tmp -o allow_other -o uid=1001 -o mp_umask=002 -o multireq_max=5 -o url=https://s3.amazonaws.com /home/cong/Space/mys3bucket -o sigv4 -o dbglevel=info -f -o curldbg -o endpoint=us-west-2 -o passwd_file=/home/cong/.aws/passwd-s3fs
```

## rclone挂载

1. 安装
```bash
curl https://rclone.org/install.sh | sudo bash
```
2. **配置 S3 存储桶**
```bash
rclone config
```

• 选择 n 创建新配置。

• 提供一个名称（如 my-s3）。

• 选择 4 (Amazon S3)。

• 填写 AWS Access Key ID 和 AWS Secret Access Key。

• 根据需要选择存储桶区域和其他设置。

```bash

# s3 tm-fs-test
rclone mount my-s3:/tm-fs-test/music /home/cong/Space/mys3bucket --daemon

# test-fsservice
rclone mount my-oss:/test-fsservice/CONG /home/cong/Space/oss --daemon
```

## rclone 常用操作
```bash
rclone config - 以控制会话的形式添加rclone的配置，配置保存在.rclone.conf文件中。
rclone copy - 将文件从源复制到目的地址，跳过已复制完成的。
rclone sync - 将源数据同步到目的地址，只更新目的地址的数据。   –dry-run标志来检查要复制、删除的数据
rclone move - 将源数据移动到目的地址。
rclone delete - 删除指定路径下的文件内容。
rclone purge - 清空指定路径下所有文件数据。
rclone mkdir - 创建一个新目录。
rclone rmdir - 删除空目录。
rclone check - 检查源和目的地址数据是否匹配。
rclone ls - 列出指定路径下所有的文件以及文件大小和路径。
rclone lsd - 列出指定路径下所有的目录/容器/桶。
rclone lsl - 列出指定路径下所有文件以及修改时间、文件大小和路径。
rclone md5sum - 为指定路径下的所有文件产生一个md5sum文件。
rclone sha1sum - 为指定路径下的所有文件产生一个sha1sum文件。
rclone size - 获取指定路径下，文件内容的总大小。.
rclone version - 查看当前版本。
rclone cleanup - 清空remote。
rclone dedupe - 交互式查找重复文件，进行删除/重命名操作。
rclone mount - 挂载云盘为本地硬盘
fusermount -qzu LocalFolder  - 卸载挂载的云盘

```

![Image](http://test-fsservice.oss-cn-shanghai.aliyuncs.com/fs/test/2024/202412231547503.jpeg)